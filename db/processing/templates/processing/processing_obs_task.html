{% extends 'processing/main.html' %}

{% load static %}

{% block extrahead %}
<link rel="stylesheet" href="{% static 'processing/epoch_overview.css' %}">
{% endblock %}

{% block body %}

<h1>Processing for {{ obs }}:{{ task }}</h1>

<div class="proc-obs-task">
  <b>Command:</b>
  <code>{{ semester_plan_processing_detail.pipeline_step.command }} {{ obs.obs }}</code>
</div>

{% for processing in processings %}
<div class="proc-obs-task">
  <b>Processing code version:</b> {{ processing.commit|default:"[Not recorded]" }}
  <br>
  <b>Cluster:</b> {{ processing.cluster.name }}
  <b>SLURM Job:</b> {{ processing.job_id }}
  <b>Array job:</b> {{ processing.array_task_id }}
  <br>
  <b>Submitted:</b> {{ processing.submission_time }}
  <b>Started:</b> {{ processing.start_time }}
  <b>Finished:</b> {{ processing.end_time }}
  <br>
  <span class="{{ processing.status }}"><b>{{ processing.status|upper }}</b></span>
  <a href="{% url 'remote_file' %}?remote_path={{ processing.batch_file_full_path }}&cluster_id={{ processing.cluster.id }}&hpc_user_id={{ processing.hpc_user_id }}">Batch file</a> -
  <a href="{% url 'remote_file' %}?remote_path={{ processing.stdout_full_path }}&cluster_id={{ processing.cluster.id }}&hpc_user_id={{ processing.hpc_user_id }}">STDOUT</a> -
  <a href="{% url 'remote_file' %}?remote_path={{ processing.stderr_full_path }}&cluster_id={{ processing.cluster.id }}&hpc_user_id={{ processing.hpc_user_id }}">STDERR</a> -
  <a href="{% url 'remote_command' %}?command=sinfo {{ processing.slurm_id }}&cluster_id={{ processing.cluster.id }}&hpc_user_id={{ processing.hpc_user_id }}">sinfo</a>
  <br>
</div>
{% endfor %}

{% endblock %}
